# åˆä½œæ–¹å±‚çº§ç®¡ç† - ä½¿ç”¨è¯´æ˜

## ğŸ“¦ æ ¸å¿ƒæ–‡ä»¶

1. **æ•°æ®åº“è¿ç§»**: `supabase/migrations/20250121_add_partner_unlimited_hierarchy.sql`
2. **å‰ç«¯é¡µé¢**: `src/pages/PartnerHierarchyManagement.tsx`
3. **è·¯ç”±é…ç½®**: å·²é›†æˆåˆ° `src/App.tsx`, `src/components/AppSidebar.tsx`, `src/components/EnhancedHeader.tsx`

---

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### 1. æ‰§è¡Œæ•°æ®åº“è¿ç§»

```powershell
psql -h localhost -p 54322 -U postgres -d postgres -f supabase/migrations/20250121_add_partner_unlimited_hierarchy.sql
```

### 2. é‡å¯å‰ç«¯

```powershell
npm run dev
```

### 3. è®¿é—®é¡µé¢

```
http://localhost:3000/partners/hierarchy
```

---

## ğŸ¯ åŠŸèƒ½ç‰¹æ€§

### æ–°å¢å­—æ®µ

- `parent_partner_id` - ä¸Šçº§åˆä½œæ–¹ID
- `hierarchy_path` - å±‚çº§è·¯å¾„ï¼ˆè‡ªåŠ¨ç»´æŠ¤ï¼‰
- `hierarchy_depth` - å±‚çº§æ·±åº¦ï¼ˆè‡ªåŠ¨ç»´æŠ¤ï¼‰
- `is_root` - æ˜¯å¦æ ¹èŠ‚ç‚¹ï¼ˆè‡ªåŠ¨ç»´æŠ¤ï¼‰

### é¡µé¢åŠŸèƒ½

- âœ… æ ‘å½¢ç»“æ„å±•ç¤º
- âœ… æ‹–æ‹½è°ƒæ•´ä¸Šä¸‹çº§å…³ç³»
- âœ… æ‰¹é‡è®¾ç½®æ ¹èŠ‚ç‚¹
- âœ… æœç´¢è¿‡æ»¤
- âœ… å±•å¼€/æŠ˜å 
- âœ… ç»Ÿè®¡ä¿¡æ¯

### æƒé™è§„åˆ™

- ä¸Šçº§å¯ä»¥æŸ¥çœ‹æ‰€æœ‰ä¸‹çº§æ•°æ®
- ä¸‹çº§å¯ä»¥æŸ¥çœ‹æ‰€æœ‰ä¸Šçº§æ•°æ®
- ä¸åŒé“¾è·¯å®Œå…¨éš”ç¦»
- ç®¡ç†å‘˜/è´¢åŠ¡å¯ä»¥æŸ¥çœ‹æ‰€æœ‰

---

## ğŸ’¡ ä½¿ç”¨æµç¨‹

### åˆæ¬¡ä½¿ç”¨

1. è®¿é—® `/partners/hierarchy`
2. ç‚¹å‡»æ©™è‰²æŒ‰é’® **"ğŸ  è®¾ç½®æ ¹èŠ‚ç‚¹ (N)"**
3. é€‰æ‹©éœ€è¦è®¾ä¸ºæ ¹çš„åˆä½œæ–¹
4. ç‚¹å‡»"è®¾ç½®ä¸ºæ ¹èŠ‚ç‚¹"

### è°ƒæ•´å±‚çº§

1. æ‹–æ‹½èŠ‚ç‚¹åˆ°ç›®æ ‡åˆä½œæ–¹
2. ç¡®è®¤æ“ä½œ
3. å±‚çº§å…³ç³»è‡ªåŠ¨æ›´æ–°

### è®¾ä¸ºç‹¬ç«‹æ ¹èŠ‚ç‚¹

1. æ‹–æ‹½èŠ‚ç‚¹åˆ°åº•éƒ¨ç»¿è‰²åŒºåŸŸ
2. ç¡®è®¤æ“ä½œ
3. æˆä¸ºç‹¬ç«‹çš„æ ¹èŠ‚ç‚¹

---

## ğŸ“Š å®é™…è¡¨ç»“æ„

**partners è¡¨**:
- id, name, tax_rate, created_at, user_id, full_name
- parent_partner_id â† æ–°å¢
- hierarchy_path â† æ–°å¢
- hierarchy_depth â† æ–°å¢
- is_root â† æ–°å¢
- updated_at â† æ–°å¢

**partner_bank_details è¡¨**ï¼ˆä¸€å¯¹ä¸€å…³è”ï¼‰:
- partner_id â†’ partners.id
- full_name, tax_number, company_address
- bank_account, bank_name, branch_name

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **tax_number** å’Œ **company_address** åœ¨ `partner_bank_details` è¡¨ï¼Œä¸åœ¨ `partners` è¡¨
2. åˆå§‹æ‰€æœ‰åˆä½œæ–¹éƒ½æ˜¯æœªåˆ†é…çŠ¶æ€ï¼ˆéœ€è¦æ‰‹åŠ¨è®¾ç½®æ ¹èŠ‚ç‚¹ï¼‰
3. è§¦å‘å™¨ä¼šè‡ªåŠ¨ç»´æŠ¤å±‚çº§è·¯å¾„å’Œæ·±åº¦
4. ä¸èƒ½æ‹–æ‹½åˆ°è‡ªå·±çš„å­å­™èŠ‚ç‚¹ï¼ˆé˜²æ­¢å¾ªç¯ï¼‰

---

**ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2025-01-21  
**çŠ¶æ€**: âœ… ç”Ÿäº§å°±ç»ª

