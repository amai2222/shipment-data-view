# 运单维护增强功能测试清单

## 📋 测试准备

### 1. 环境检查
- [ ] 确认已启动开发服务器
- [ ] 确认数据库连接正常
- [ ] 确认有管理员或操作员权限
- [ ] 确认有测试项目数据

### 2. 测试数据准备
- [ ] 下载增强模板
- [ ] 准备多种日期格式的测试数据
- [ ] 准备外部平台数据测试
- [ ] 准备错误数据用于验证测试

## 🧪 功能测试

### 一、日期解析测试

#### 测试用例1：标准日期格式
```excel
装货日期: 2025-01-15
预期结果: ✅ 解析成功
```
- [ ] 测试通过
- [ ] 日志显示"标准格式日期解析成功"

#### 测试用例2：斜杠格式
```excel
装货日期: 2025/1/15
预期结果: ✅ 解析成功，转换为 2025-01-15
```
- [ ] 测试通过
- [ ] 日志显示"斜杠格式日期解析成功"

#### 测试用例3：中文格式
```excel
装货日期: 5月20日
预期结果: ✅ 解析成功，转换为 2025-05-20（当年）
```
- [ ] 测试通过
- [ ] 日志显示"中文格式日期解析成功（当年）"

#### 测试用例4：完整中文格式
```excel
装货日期: 2025年12月25日
预期结果: ✅ 解析成功，转换为 2025-12-25
```
- [ ] 测试通过
- [ ] 日志显示"中文格式日期解析成功"

#### 测试用例5：短格式
```excel
装货日期: 3/15
预期结果: ✅ 解析成功，转换为 2025-03-15（当年）
```
- [ ] 测试通过
- [ ] 日志显示"短格式日期解析成功（当年）"

#### 测试用例6：Excel数字日期
```excel
装货日期: 44927（Excel内部格式）
预期结果: ✅ 解析成功，转换为正确的日期
```
- [ ] 测试通过
- [ ] 日志显示"Excel数字日期解析成功"

#### 测试用例7：错误日期格式
```excel
装货日期: 2025/13/45（无效日期）
预期结果: ❌ 解析失败，显示错误信息
```
- [ ] 测试通过
- [ ] 日志显示"日期解析失败"警告
- [ ] 该行数据被跳过

### 二、外部平台数据测试

#### 测试用例1：单平台单运单号
```excel
其他平台名称: 平台A
其他平台运单号: 运单001
预期结果: ✅ 生成正确的JSONB格式
```
- [ ] 测试通过
- [ ] 数据库中正确存储
- [ ] 日志显示平台数据处理成功

#### 测试用例2：单平台多运单号
```excel
其他平台名称: 平台A
其他平台运单号: 运单001|运单002|运单003
预期结果: ✅ 生成3条运单号记录
```
- [ ] 测试通过
- [ ] 所有运单号都正确存储
- [ ] 日志显示"处理平台 平台A: 3个运单号"

#### 测试用例3：多平台多运单号
```excel
其他平台名称: 平台A,平台B,平台C
其他平台运单号: 运单1|运单2,运单3|运单4,运单5|运单6
预期结果: ✅ 生成6条运单号记录，分属3个平台
```
- [ ] 测试通过
- [ ] 每个平台的运单号正确分组
- [ ] 日志显示所有平台的处理信息

#### 测试用例4：平台数量不匹配
```excel
其他平台名称: 平台A,平台B
其他平台运单号: 运单1|运单2,运单3|运单4,运单5
预期结果: ❌ 验证失败，显示错误信息
```
- [ ] 测试通过
- [ ] 显示"平台名称数量与运单号组数量不匹配"错误
- [ ] 该行数据被标记为无效

### 三、字段验证测试

#### 测试用例1：必填字段缺失
```excel
项目名称: （空）
司机姓名: 张三
预期结果: ❌ 验证失败
```
- [ ] 测试通过
- [ ] 显示"项目名称是必填字段"错误
- [ ] 该行数据被标记为无效

#### 测试用例2：数字格式错误
```excel
装货数量: abc（非数字）
预期结果: ❌ 验证失败
```
- [ ] 测试通过
- [ ] 显示"装货数量必须是数字"错误
- [ ] 该行数据被标记为无效

#### 测试用例3：手机号格式错误
```excel
司机电话: 12345（无效手机号）
预期结果: ❌ 验证失败
```
- [ ] 测试通过
- [ ] 显示"必须是有效的手机号码格式"错误
- [ ] 该行数据被标记为无效

#### 测试用例4：车牌号格式错误
```excel
车牌号: @#$%（特殊字符）
预期结果: ❌ 验证失败
```
- [ ] 测试通过
- [ ] 显示"车牌号格式不正确"错误
- [ ] 该行数据被标记为无效

#### 测试用例5：所有字段正确
```excel
项目名称: 测试项目
司机姓名: 张三
车牌号: 京A12345
装货地点: 北京仓库
卸货地点: 上海仓库
装货日期: 2025-01-15
装货数量: 10.5
预期结果: ✅ 验证通过
```
- [ ] 测试通过
- [ ] 所有字段验证成功
- [ ] 数据被标记为有效

### 四、模板生成测试

#### 测试用例1：下载增强模板
- [ ] 点击"模板"按钮
- [ ] 成功下载Excel文件
- [ ] 文件名为"运单导入模板.xlsx"
- [ ] 显示成功提示

#### 测试用例2：模板内容检查
- [ ] 包含彩色标题行
- [ ] 包含字段说明行
- [ ] 包含计费类型说明行
- [ ] 包含5种示例数据
- [ ] 包含10条使用说明
- [ ] 列宽自动调整合适

#### 测试用例3：模板格式验证
- [ ] 上传模板文件
- [ ] 系统识别表头正确
- [ ] 必需字段检查通过
- [ ] 显示"表头验证通过"日志

### 五、导入流程测试

#### 测试用例1：完整导入流程
1. **上传阶段**
   - [ ] 选择Excel文件
   - [ ] 显示"开始处理Excel文件"日志
   - [ ] 显示文件名和大小

2. **解析阶段**
   - [ ] 显示"Excel文件解析成功"日志
   - [ ] 显示总行数
   - [ ] 显示工作表名称

3. **验证阶段**
   - [ ] 显示"数据预处理完成"日志
   - [ ] 显示有效行数
   - [ ] 显示"数据验证完成"日志

4. **预览阶段**
   - [ ] 显示导入预览对话框
   - [ ] 显示准备导入的记录数
   - [ ] 显示详细的导入日志
   - [ ] 显示"准备导入 X 条记录"信息

5. **执行阶段**
   - [ ] 点击"确认导入"按钮
   - [ ] 显示进度条
   - [ ] 显示"开始执行导入"日志
   - [ ] 显示"准备导入数据..."状态

6. **完成阶段**
   - [ ] 显示"导入完成"日志
   - [ ] 显示成功和失败统计
   - [ ] 显示成功率
   - [ ] 显示成功提示

#### 测试用例2：部分失败场景
- [ ] 上传包含错误数据的文件
- [ ] 系统继续处理有效数据
- [ ] 显示详细的错误信息
- [ ] 显示"导入部分完成"提示
- [ ] 统计正确显示成功和失败数量

#### 测试用例3：全部失败场景
- [ ] 上传全部错误的数据
- [ ] 显示"没有有效的数据可以导入"错误
- [ ] 不执行导入操作
- [ ] 显示详细的错误列表

### 六、日志系统测试

#### 测试用例1：日志级别
- [ ] INFO日志显示为灰色
- [ ] WARN日志显示为黄色
- [ ] ERROR日志显示为红色
- [ ] SUCCESS日志显示为绿色

#### 测试用例2：日志内容
- [ ] 每条日志包含时间戳
- [ ] 每条日志包含级别标识
- [ ] 每条日志包含详细信息
- [ ] 日志按时间顺序排列

#### 测试用例3：日志滚动
- [ ] 日志区域可以滚动
- [ ] 新日志自动滚动到底部
- [ ] 日志区域高度适中

### 七、进度显示测试

#### 测试用例1：进度条
- [ ] 显示当前进度/总数
- [ ] 显示百分比
- [ ] 进度条动画流畅
- [ ] 进度更新及时

#### 测试用例2：状态描述
- [ ] 显示"准备中..."
- [ ] 显示"准备导入数据..."
- [ ] 显示"导入完成"
- [ ] 状态描述准确

### 八、错误处理测试

#### 测试用例1：文件格式错误
- [ ] 上传非Excel文件
- [ ] 显示"文件处理失败"错误
- [ ] 显示具体错误原因
- [ ] 不执行导入操作

#### 测试用例2：空文件
- [ ] 上传空Excel文件
- [ ] 显示"Excel文件至少需要包含表头和一行数据"错误
- [ ] 不执行导入操作

#### 测试用例3：缺少表头
- [ ] 上传缺少必需表头的文件
- [ ] 显示"缺少必需的表头"错误
- [ ] 列出缺少的表头名称
- [ ] 不执行导入操作

#### 测试用例4：数据库错误
- [ ] 模拟数据库连接失败
- [ ] 显示"导入失败"错误
- [ ] 显示具体错误信息
- [ ] 日志记录错误详情

### 九、权限控制测试

#### 测试用例1：管理员权限
- [ ] 以管理员身份登录
- [ ] 可以访问运单维护页面
- [ ] 可以执行所有操作

#### 测试用例2：操作员权限
- [ ] 以操作员身份登录
- [ ] 可以访问运单维护页面
- [ ] 可以执行所有操作

#### 测试用例3：无权限
- [ ] 以普通用户身份登录
- [ ] 显示"权限不足"提示
- [ ] 无法访问功能

### 十、UI/UX测试

#### 测试用例1：响应式设计
- [ ] 在不同屏幕尺寸下显示正常
- [ ] 按钮大小适中
- [ ] 文字清晰可读

#### 测试用例2：交互反馈
- [ ] 按钮点击有反馈
- [ ] 加载状态显示清晰
- [ ] 错误提示明显
- [ ] 成功提示友好

#### 测试用例3：用户引导
- [ ] 提示信息清晰
- [ ] 操作流程直观
- [ ] 帮助信息完整

## 📊 测试结果统计

### 测试概览
- 总测试用例数: 60+
- 通过数: ___
- 失败数: ___
- 跳过数: ___
- 通过率: ___%

### 问题记录
| 编号 | 测试用例 | 问题描述 | 严重程度 | 状态 |
|------|---------|---------|---------|------|
| 1    |         |         |         |      |
| 2    |         |         |         |      |
| 3    |         |         |         |      |

### 性能测试
- [ ] 小文件（<100行）导入速度: ___ 秒
- [ ] 中文件（100-1000行）导入速度: ___ 秒
- [ ] 大文件（>1000行）导入速度: ___ 秒
- [ ] 内存占用: ___ MB
- [ ] CPU占用: ___%

## ✅ 测试完成确认

- [ ] 所有核心功能测试通过
- [ ] 所有错误处理测试通过
- [ ] 所有UI/UX测试通过
- [ ] 性能测试达标
- [ ] 文档完整准确

## 📝 测试备注

```
测试日期: ___________
测试人员: ___________
测试环境: ___________
备注说明: ___________
```

---

**测试状态**: ⏳ 待测试
**最后更新**: 2025年10月9日
