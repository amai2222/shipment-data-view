# 运单导入模板使用说明

## 📋 概述

运单导入模板支持批量导入运单数据，包括基础运单信息和平台运单信息。本文档详细说明如何使用导入模板，特别是如何正确填写其他平台和运单号信息。

## 📊 模板结构

### 1. 基础字段（必填）

| 列名 | 说明 | 示例 | 备注 |
|------|------|------|------|
| 项目名称 | 运单所属项目 | 示例项目A | 必填，必须在系统中存在 |
| 司机姓名 | 司机姓名 | 张三 | 必填 |
| 装货地点 | 装货地点名称 | 北京仓库 | 必填 |
| 卸货地点 | 卸货地点名称 | 上海仓库 | 必填 |
| 装货日期 | 装货日期 | 2025-01-20 | 必填，格式：YYYY-MM-DD |

### 2. 基础字段（选填）

| 列名 | 说明 | 示例 | 备注 |
|------|------|------|------|
| 合作链路 | 合作链路名称 | 合作方A-链路1 | 选填 |
| 车牌号 | 车辆车牌号 | 京A12345 | 选填 |
| 司机电话 | 司机联系电话 | 13800138000 | 选填 |
| 卸货日期 | 卸货日期 | 2025-01-21 | 选填，格式：YYYY-MM-DD |
| 运输类型 | 运输类型 | 实际运输 | 选填，默认：实际运输 |
| 装货重量 | 装货重量（吨） | 25.5 | 选填，数字 |
| 卸货重量 | 卸货重量（吨） | 25.3 | 选填，数字 |
| 运费金额 | 运费金额（元） | 1500.00 | 选填，数字 |
| 额外费用 | 额外费用（元） | 100.00 | 选填，数字，支持负数 |
| 备注 | 备注信息 | 正常运输 | 选填 |

### 3. 平台运单信息字段（选填）

| 列名 | 说明 | 示例 | 备注 |
|------|------|------|------|
| 其他平台名称 | 其他平台名称列表 | 货拉拉,满帮,运满满 | 选填，多个用逗号分隔 |
| 其他平台运单号 | 对应的运单号列表 | HL20250120001,MB20250120001,YM20250120001 | 选填，逗号分隔不同平台，\|分隔同一平台的多个运单号 |
| 其他平台运单号说明 | 填写说明 | 逗号分隔不同平台，\|分隔同一平台的多个运单号 | 仅用于说明，不导入 |

## 🎯 平台运单信息填写规则

### 1. 基本规则

- **平台名称**：用逗号分隔不同平台
- **运单号**：用逗号分隔不同平台的运单号组合，用|分隔同一平台的多个运单号
- 平台名称和运单号按顺序一一对应
- 支持一个平台对应多个运单号
- 支持只有平台名称，无运单号的情况

### 2. 填写示例

#### 示例1：多个平台，每个平台一个运单号
```
其他平台名称: 货拉拉,满帮,运满满
其他平台运单号: HL20250120001,MB20250120001,YM20250120001
```
**结果**：
- 货拉拉 → HL20250120001
- 满帮 → MB20250120001  
- 运满满 → YM20250120001

#### 示例2：一个平台，多个运单号
```
其他平台名称: 货拉拉
其他平台运单号: HL20250120002|HL20250120003
```
**结果**：
- 货拉拉 → [HL20250120002, HL20250120003]

#### 示例3：只有平台名称，无运单号
```
其他平台名称: 滴滴货运
其他平台运单号: (空)
```
**结果**：
- 滴滴货运 → []

#### 示例4：混合情况
```
其他平台名称: 货拉拉,满帮,滴滴货运
其他平台运单号: HL20250120001|HL20250120002,MB20250120001,
```
**结果**：
- 货拉拉 → [HL20250120001, HL20250120002]
- 满帮 → [MB20250120001]
- 滴滴货运 → []

### 3. 分隔符规则

- **逗号(,)**：分隔不同平台或不同平台的运单号组合
- **竖线(|)**：分隔同一平台的多个运单号
- **空值**：如果某个平台没有运单号，在对应位置留空或写空字符串

## 📝 完整示例

### 示例数据1：标准运单
```
项目名称: 示例项目A
合作链路: 合作方A-链路1
司机姓名: 张三
车牌号: 京A12345
司机电话: 13800138000
装货地点: 北京仓库
卸货地点: 上海仓库
装货日期: 2025-01-20
卸货日期: 2025-01-21
运输类型: 实际运输
装货重量: 25.5
卸货重量: 25.3
运费金额: 1500.00
额外费用: 100.00
备注: 正常运输
其他平台名称: 货拉拉,满帮,运满满
其他平台运单号: HL20250120001,MB20250120001,YM20250120001
```

### 示例数据2：多运单号运单
```
项目名称: 示例项目B
司机姓名: 李四
车牌号: 沪B67890
司机电话: 13900139000
装货地点: 上海仓库
卸货地点: 广州仓库
装货日期: 2025-01-20
运输类型: 实际运输
装货重量: 30.0
卸货重量: 29.8
运费金额: 2000.00
额外费用: 0.00
其他平台名称: 货拉拉
其他平台运单号: HL20250120002,HL20250120003
```

### 示例数据3：只有平台名称
```
项目名称: 示例项目C
司机姓名: 王五
车牌号: 粤C11111
司机电话: 13700137000
装货地点: 广州仓库
卸货地点: 深圳仓库
装货日期: 2025-01-20
运输类型: 退货
装货重量: 15.0
卸货重量: 15.0
运费金额: 800.00
额外费用: -50.00
备注: 退货运输
其他平台名称: 滴滴货运
其他平台运单号: (空)
```

## ⚠️ 注意事项

### 1. 数据格式要求
- **日期格式**：必须使用 YYYY-MM-DD 格式
- **数字格式**：重量和金额使用数字，支持小数
- **分隔符**：平台名称和运单号使用英文逗号分隔
- **编码**：文件必须使用UTF-8编码

### 2. 数据验证
- 项目名称必须在系统中存在
- 司机姓名、装货地点、卸货地点会自动创建
- 平台名称和运单号会自动过滤空值
- 重复的运单号会被自动去重

### 3. 错误处理
- 必填字段为空的行会被跳过
- 格式错误的日期会被跳过
- 无效的数字格式会被跳过
- 导入完成后会显示成功和失败的统计信息

## 🚀 使用步骤

### 1. 下载模板
1. 进入"数据导入"页面
2. 点击"下载模板"按钮
3. 保存Excel文件到本地

### 2. 填写数据
1. 打开下载的Excel文件
2. 参考示例数据填写运单信息
3. 特别注意平台运单信息的填写格式
4. 保存文件

### 3. 导入数据
1. 在"数据导入"页面点击"选择文件"
2. 选择填写好的Excel文件
3. 点击"开始导入"
4. 等待导入完成，查看结果

### 4. 验证结果
1. 查看导入统计信息
2. 检查运单列表确认数据正确
3. 如有错误，根据提示修改后重新导入

## 📊 导入结果说明

导入完成后会显示以下信息：
- **成功数量**：成功导入的运单数量
- **失败数量**：导入失败的运单数量
- **错误详情**：失败原因和具体行号

## 🔧 常见问题

### Q1: 平台名称和运单号数量不匹配怎么办？
A: 系统会按智能匹配规则处理，建议按照一一对应的方式填写。

### Q2: 可以只填写平台名称，不填写运单号吗？
A: 可以，这样会创建只有平台名称，无运单号的记录。

### Q3: 运单号可以重复吗？
A: 可以，系统不会检查运单号的唯一性。

### Q4: 导入失败怎么办？
A: 查看错误详情，修改对应行的数据后重新导入。

### Q5: 可以导入多少条数据？
A: 建议单次导入不超过1000条，大量数据可以分批导入。

## 📞 技术支持

如果在使用过程中遇到问题，请：
1. 检查数据格式是否正确
2. 查看错误提示信息
3. 联系技术支持团队
