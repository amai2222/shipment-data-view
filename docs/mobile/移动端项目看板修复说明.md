# 移动端项目看板点击问题修复说明

## 🐛 问题描述

在移动端访问"项目看板"（`/m/dashboard/project`），点击具体项目后无法打开项目详情页面。

## 🔍 问题原因

路由配置错误。移动端的"项目看板"路由 `/m/dashboard/project` 使用的是**桌面端组件** `ProjectsOverview`，该组件在点击项目时会导航到桌面端路由 `/project/${id}`，而不是移动端路由 `/m/projects/detail/${id}`。

### 问题代码位置

**src/App.tsx** (修复前)
```tsx
<Route path="/m/dashboard/project" element={
  <ProtectedRoute requiredRoles={['admin', 'finance', 'business', 'viewer']}>
    <MobileLayout><ProjectsOverview /></MobileLayout>
  </ProtectedRoute>
} />
```

**src/pages/ProjectsOverview.tsx** (第211行)
```tsx
onClick={() => navigate(`/project/${projectData.project_details.id}`)}
```

## ✅ 解决方案

将移动端路由改为使用**移动端专用组件** `MobileProjectOverview`，该组件会正确导航到移动端路由。

### 修复代码

**src/App.tsx** (修复后)
```tsx
<Route path="/m/dashboard/project" element={
  <ProtectedRoute requiredRoles={['admin', 'finance', 'business', 'viewer']}>
    <MobileProjectOverview />
  </ProtectedRoute>
} />
```

**MobileProjectOverview.tsx** (第534行和第581行)
```tsx
onClick={() => navigate(`/m/projects/detail/${project.id}`)}
```

## 📋 验证步骤

1. ✅ 在移动端访问"项目看板"（`/m/dashboard/project`）
2. ✅ 点击任意项目卡片
3. ✅ 确认能够正常跳转到项目详情页（`/m/projects/detail/${projectId}`）
4. ✅ 确认项目详情页能够正常显示数据

## 🎯 相关路由说明

### 移动端项目相关路由

| 路由路径 | 组件 | 说明 |
|---------|------|------|
| `/m/dashboard/project` | `MobileProjectOverview` | 项目看板（从侧边栏进入） |
| `/m/projects` | `MobileProjectOverview` | 项目管理（直接访问） |
| `/m/projects/detail/:projectId` | `MobileProjectDetail` | 项目详情页 |
| `/m/projects/detail/:projectId/records` | `MobileProjectRecords` | 项目运单记录 |
| `/m/projects/detail/:projectId/dashboard` | `MobileProjectDashboardDetail` | 项目数据看板 |

### 桌面端项目相关路由

| 路由路径 | 组件 | 说明 |
|---------|------|------|
| `/dashboard/project` | `ProjectsOverview` | 项目看板（桌面端） |
| `/projects` | `Projects` | 项目管理（桌面端） |
| `/project/:projectId` | `ProjectDashboard` | 项目详情页（桌面端） |

## 🔧 其他发现

### 组件使用情况

1. **MobileProjectOverview** - 移动端项目总览
   - 现代化设计
   - 统计卡片展示
   - 项目列表
   - 搜索和筛选功能
   - 正确的移动端导航

2. **ProjectsOverview** - 桌面端项目总览
   - 完整的数据看板
   - 图表展示
   - 适合大屏幕显示
   - 桌面端导航

### 移动端布局

`MobileProjectOverview` 组件内部已经使用了 `<MobileLayout>`，因此在路由配置中不需要再包裹一层。

## 📝 注意事项

1. **路由一致性**: 确保移动端路由（`/m/`开头）使用移动端组件
2. **组件导航**: 移动端组件应导航到移动端路由
3. **权限控制**: 移动端和桌面端可以有不同的权限要求
4. **布局管理**: 注意组件是否已经包含布局，避免重复包裹

## ✨ 修复结果

- ✅ 移动端项目看板可以正常点击项目
- ✅ 正确跳转到移动端项目详情页
- ✅ 保持了移动端的导航逻辑
- ✅ 无linter错误
- ✅ 路由配置清晰明确

---

**修复日期**: 2025年1月8日  
**影响范围**: 移动端项目看板功能  
**状态**: ✅ 已解决

