# Cloudflare Pages éƒ¨ç½²é…ç½®è¯´æ˜

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£è¯´æ˜å¦‚ä½•åœ¨ Cloudflare Pages ä¸Šéƒ¨ç½²é¡¹ç›®ï¼Œå¹¶ç¡®ä¿æ„å»ºéªŒè¯è„šæœ¬æ­£å¸¸å·¥ä½œã€‚

## ğŸš€ Cloudflare Pages é…ç½®æ­¥éª¤

### 1. è¿æ¥ GitHub ä»“åº“

1. ç™»å½• [Cloudflare Dashboard](https://dash.cloudflare.com/)
2. è¿›å…¥ **Pages** â†’ **Create a project**
3. é€‰æ‹© **Connect to Git**
4. é€‰æ‹©ä½ çš„ GitHub ä»“åº“
5. æˆæƒ Cloudflare è®¿é—®ä»“åº“

### 2. é…ç½®æ„å»ºè®¾ç½®

åœ¨ Cloudflare Pages é¡¹ç›®è®¾ç½®ä¸­é…ç½®ï¼š

- **Framework preset**: `Vite` æˆ– `None`ï¼ˆæ‰‹åŠ¨é…ç½®ï¼‰
- **Build command**: `npm run build`
- **Build output directory**: `dist`
- **Root directory**: `/`ï¼ˆé¡¹ç›®æ ¹ç›®å½•ï¼‰
- **Node.js version**: `18` æˆ– `20`

### 3. ç¯å¢ƒå˜é‡é…ç½®

åœ¨ Cloudflare Pages é¡¹ç›®è®¾ç½® â†’ **Environment variables** ä¸­æ·»åŠ ï¼š

```
VITE_SUPABASE_URL=ä½ çš„Supabaseé¡¹ç›®URL
VITE_SUPABASE_ANON_KEY=ä½ çš„SupabaseåŒ¿åå¯†é’¥
```

### 4. è‡ªå®šä¹‰åŸŸåé…ç½®

1. åœ¨é¡¹ç›®è®¾ç½®ä¸­ç‚¹å‡» **Custom domains**
2. æ·»åŠ ä½ çš„åŸŸåï¼ˆå¦‚ `ynzkzy.325218.xyz`ï¼‰
3. æŒ‰ç…§æç¤ºé…ç½® DNS è®°å½•

## âœ… æ„å»ºéªŒè¯

### è‡ªåŠ¨éªŒè¯

æ„å»ºå‘½ä»¤ `npm run build` ä¼šè‡ªåŠ¨è¿è¡ŒéªŒè¯è„šæœ¬ï¼š

```bash
npm run build
# ç­‰åŒäº: vite build && node scripts/verify-build.js
```

å¦‚æœéªŒè¯å¤±è´¥ï¼Œæ„å»ºä¼šç«‹å³åœæ­¢ï¼ŒCloudflare Pages ä¼šæ˜¾ç¤ºæ„å»ºå¤±è´¥ã€‚

### éªŒè¯å†…å®¹

éªŒè¯è„šæœ¬ä¼šæ£€æŸ¥ï¼š
- âœ… `dist/index.html` æ˜¯å¦å­˜åœ¨
- âœ… `dist/assets/` ç›®å½•æ˜¯å¦å­˜åœ¨
- âœ… æ‰€æœ‰å¼•ç”¨çš„ JavaScript æ–‡ä»¶æ˜¯å¦å­˜åœ¨
- âœ… æ–‡ä»¶å¤§å°æ˜¯å¦æ­£å¸¸ï¼ˆä¸ä¸ºç©ºï¼‰
- âœ… æ‰€æœ‰æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®

### æŸ¥çœ‹æ„å»ºæ—¥å¿—

åœ¨ Cloudflare Pages Dashboard ä¸­ï¼š
1. è¿›å…¥é¡¹ç›® â†’ **Deployments**
2. ç‚¹å‡»å…·ä½“çš„éƒ¨ç½²è®°å½•
3. æŸ¥çœ‹ **Build logs** éƒ¨åˆ†

å¦‚æœéªŒè¯å¤±è´¥ï¼Œæ—¥å¿—ä¸­ä¼šæ˜¾ç¤ºï¼š
```
âŒ é”™è¯¯: assets ç›®å½•ä¸­æ²¡æœ‰ JavaScript æ–‡ä»¶ï¼
âŒ æ„å»ºéªŒè¯å¤±è´¥ï¼è¯·æ£€æŸ¥æ„å»ºè¿‡ç¨‹ã€‚
```

## ğŸ”§ æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: æ„å»ºéªŒè¯å¤±è´¥

**ç—‡çŠ¶**: æ„å»ºæ—¥å¿—æ˜¾ç¤ºéªŒè¯å¤±è´¥

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥æ„å»ºæ—¥å¿—ï¼Œæ‰¾åˆ°å…·ä½“çš„é”™è¯¯ä¿¡æ¯
2. ç¡®è®¤æ‰€æœ‰ä¾èµ–å·²æ­£ç¡®å®‰è£…
3. æ£€æŸ¥ç¯å¢ƒå˜é‡æ˜¯å¦æ­£ç¡®é…ç½®
4. å°è¯•æœ¬åœ°æ„å»ºï¼š`npm run build`

### é—®é¢˜ 2: æ–‡ä»¶ 404 é”™è¯¯

**ç—‡çŠ¶**: é¡µé¢åŠ è½½æ—¶å‡ºç° `Failed to fetch dynamically imported module`

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥æ„å»ºæ—¥å¿—ï¼Œç¡®è®¤æ‰€æœ‰æ–‡ä»¶éƒ½å·²ç”Ÿæˆ
2. æ£€æŸ¥ `_redirects` æ–‡ä»¶æ˜¯å¦æ­£ç¡®é…ç½®
3. æ¸…é™¤ Cloudflare ç¼“å­˜ï¼š
   - è¿›å…¥ Cloudflare Dashboard
   - é€‰æ‹©ä½ çš„åŸŸå
   - **Caching** â†’ **Purge Everything**

### é—®é¢˜ 3: SPA è·¯ç”±ä¸å·¥ä½œ

**ç—‡çŠ¶**: ç›´æ¥è®¿é—®è·¯ç”±è¿”å› 404

**è§£å†³æ–¹æ¡ˆ**:
ç¡®ä¿ `public/_redirects` æ–‡ä»¶å­˜åœ¨ä¸”å†…å®¹æ­£ç¡®ï¼š
```
/*    /index.html   200
```

## ğŸ“ é‡è¦æ–‡ä»¶

### `public/_redirects`
ç”¨äº Cloudflare Pages çš„ SPA è·¯ç”±é‡å®šå‘ã€‚

### `scripts/verify-build.js`
æ„å»ºéªŒè¯è„šæœ¬ï¼Œç¡®ä¿æ‰€æœ‰æ–‡ä»¶æ­£ç¡®ç”Ÿæˆã€‚

### `package.json`
åŒ…å«æ„å»ºå‘½ä»¤ï¼Œè‡ªåŠ¨è¿è¡ŒéªŒè¯è„šæœ¬ã€‚

## ğŸ¯ æœ€ä½³å®è·µ

1. **æ¯æ¬¡éƒ¨ç½²å‰éªŒè¯**ï¼š
   - æœ¬åœ°è¿è¡Œ `npm run build` ç¡®ä¿æ„å»ºæˆåŠŸ
   - æ£€æŸ¥æ„å»ºè¾“å‡ºæ˜¯å¦åŒ…å«æ‰€æœ‰æ–‡ä»¶

2. **ç›‘æ§æ„å»ºæ—¥å¿—**ï¼š
   - å®šæœŸæ£€æŸ¥ Cloudflare Pages çš„æ„å»ºæ—¥å¿—
   - å…³æ³¨éªŒè¯è„šæœ¬çš„è¾“å‡º

3. **ç‰ˆæœ¬æ§åˆ¶**ï¼š
   - ç¡®ä¿æ‰€æœ‰é…ç½®æ–‡ä»¶éƒ½æäº¤åˆ° Git
   - ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†æ•æ„Ÿä¿¡æ¯

4. **ç¼“å­˜ç­–ç•¥**ï¼š
   - é™æ€èµ„æºä½¿ç”¨é•¿æœŸç¼“å­˜
   - HTML æ–‡ä»¶ä¸ç¼“å­˜

## ğŸ”— ç›¸å…³èµ„æº

- [Cloudflare Pages æ–‡æ¡£](https://developers.cloudflare.com/pages/)
- [Vite æ„å»ºé…ç½®](https://vitejs.dev/config/)
- [æ„å»ºéƒ¨ç½²é—®é¢˜æ’æŸ¥æŒ‡å—](./æ„å»ºéƒ¨ç½²é—®é¢˜æ’æŸ¥æŒ‡å—.md)

