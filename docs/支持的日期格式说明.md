# Excel导入支持的日期格式说明

## 📅 支持的日期格式

系统现在支持多种Excel常见的日期格式，包括中文日期格式，让用户使用更加灵活。

### **标准格式**
| 格式示例 | 说明 | 示例 |
|----------|------|------|
| `YYYY-MM-DD` | ISO标准格式 | `2025-01-21` |
| `YYYY-MM-DDTHH:mm:ss` | ISO带时间格式 | `2025-01-21T00:00:00` |
| `YYYY-MM-DDTHH:mm:ss+HH:mm` | ISO带时区格式 | `2025-01-21T00:00:00+08:00` |
| `YYYY/MM/DD` | 斜杠分隔格式 | `2025/01/21` |
| `MM/DD/YYYY` | 美式格式 | `01/21/2025` |
| `MM-DD-YYYY` | 美式横线格式 | `01-21-2025` |
| `YYYY.MM.DD` | 点号分隔格式 | `2025.01.21` |
| `DD.MM.YYYY` | 欧式格式 | `21.01.2025` |

### **中文格式**
| 格式示例 | 说明 | 示例 |
|----------|------|------|
| `M月D日` | 中文月日格式（使用当前年份） | `5月20日` |
| `YYYY年M月D日` | 完整中文格式 | `2025年5月20日` |

### **简化格式（使用当前年份）**
| 格式示例 | 说明 | 示例 |
|----------|------|------|
| `M/D` | 月/日格式 | `5/20` |
| `M-D` | 月-日格式 | `5-20` |
| `M.D` | 月.日格式 | `5.20` |

### **Excel序列号格式**
| 格式示例 | 说明 | 示例 |
|----------|------|------|
| 数字 | Excel日期序列号 | `45321` |

## 🎯 使用示例

### **在Excel中填写日期**
您可以在Excel的"装货日期"和"卸货日期"列中使用以下任意格式：

```
装货日期列示例：
2025-01-21
5月20日
2025年12月25日
3/15
12-25
5.20
```

### **自动年份处理**
- 对于只有月日的格式（如 `5月20日`、`3/15`），系统会自动使用当前年份
- 如果当前是2025年，`5月20日` 会被解析为 `2025-05-20`

### **验重功能**
所有格式都会被统一转换为标准格式进行重复检测，确保：
- `2025-01-21` 和 `2025年1月21日` 会被识别为相同日期
- `5月20日` 和 `5/20` 会被识别为相同日期（同一年份）

## ⚠️ 注意事项

### **格式要求**
1. **月份和日期**：可以是1-2位数字
2. **年份**：完整4位数字或省略（使用当前年份）
3. **分隔符**：支持 `-`、`/`、`.` 和中文 `年`、`月`、`日`
4. **空格**：系统会自动去除前后空格

### **错误格式示例**
以下格式会导致解析失败：
- `21/01/25` （年份不完整）
- `1月` （缺少日期）
- `20日` （缺少月份）
- `2025-13-01` （月份超出范围）
- `2025-01-32` （日期超出范围）

### **建议格式**
为了确保最佳兼容性，建议使用：
- **标准格式**：`2025-01-21`
- **中文格式**：`2025年1月21日`
- **简化格式**：`1/21`（当前年份）

## 🔧 技术实现

### **前端处理**
- 使用 `parseExcelDate()` 函数解析各种格式
- 支持Excel序列号日期转换
- 自动处理时区和格式转换

### **后端处理**
- 使用正则表达式匹配不同格式
- 支持多种日期解析函数
- 使用 `DATE()` 函数确保只比较日期部分

### **验重逻辑**
- 所有日期格式统一转换为 `YYYY-MM-DD` 格式
- 使用 `DATE(loading_date) = parsed_date` 进行比较
- 忽略时区信息，只比较日期部分

## 📝 更新日志

- **2025-01-21**：新增中文日期格式支持
- **2025-01-21**：新增简化格式支持
- **2025-01-21**：修复时区日期比较问题
- **2025-01-21**：增强错误处理和提示
