# æ•°æ®åº“ä¼˜åŒ–æ‰§è¡Œæ­¥éª¤

## ğŸ“‹ éœ€è¦æ‰§è¡Œçš„æ–‡ä»¶ï¼ˆæŒ‰é¡ºåºï¼‰

### æ­¥éª¤ 1ï¼šåˆ›å»ºç´¢å¼•æ–‡ä»¶

#### 1.1 ä»˜æ¬¾ç´¢å¼•
```sql
-- æ–‡ä»¶ï¼šsupabase/migrations/20251120_create_payment_indexes.sql
-- è¯´æ˜ï¼šåˆ›å»º4ä¸ªä»˜æ¬¾ç›¸å…³çš„æ€§èƒ½ç´¢å¼•
```

#### 1.2 å¼€ç¥¨ç´¢å¼•
```sql
-- æ–‡ä»¶ï¼šsupabase/migrations/20251120_create_invoice_indexes.sql  
-- è¯´æ˜ï¼šåˆ›å»º5ä¸ªå¼€ç¥¨ç›¸å…³çš„æ€§èƒ½ç´¢å¼•
```

### æ­¥éª¤ 2ï¼šåˆ›å»ºå‡½æ•°æ–‡ä»¶

#### 2.1 ä»˜æ¬¾å‡½æ•°
```sql
-- æ–‡ä»¶ï¼šsupabase/migrations/20251120_optimize_payment_request_data_function.sql
-- è¯´æ˜ï¼šåˆ›å»ºä¼˜åŒ–çš„ get_payment_request_data_1120 å‡½æ•°
```

#### 2.2 å¼€ç¥¨å‡½æ•°ï¼ˆâš ï¸ é‡è¦ï¼ï¼‰
```sql
-- æ–‡ä»¶ï¼šsupabase/migrations/20251120_optimize_invoice_request_data_function.sql
-- è¯´æ˜ï¼šåˆ›å»ºä¼˜åŒ–çš„ get_invoice_request_data_1120 å‡½æ•°
```

---

## ğŸš¨ å½“å‰é—®é¢˜

**å¼€ç¥¨ç”³è¯·é¡µé¢æŠ¥é”™ï¼š** "åŠ è½½å¼€ç¥¨ç”³è¯·æ•°æ®å¤±è´¥"

**åŸå› ï¼š** `get_invoice_request_data_1120` å‡½æ•°è¿˜æ²¡æœ‰åœ¨æ•°æ®åº“ä¸­åˆ›å»º

---

## âœ… è§£å†³æ–¹æ³•

### æ–¹æ³•1ï¼šåœ¨ Supabase Dashboard ä¸­æ‰§è¡Œ

1. æ‰“å¼€ Supabase Dashboard
2. è¿›å…¥ SQL Editor
3. ä¾æ¬¡å¤åˆ¶å¹¶æ‰§è¡Œä»¥ä¸‹æ–‡ä»¶çš„å†…å®¹ï¼š
   - `20251120_create_invoice_indexes.sql`
   - `20251120_optimize_invoice_request_data_function.sql`

### æ–¹æ³•2ï¼šä½¿ç”¨ Supabase CLI

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
supabase migration up
```

---

## ğŸ” éªŒè¯æ˜¯å¦æˆåŠŸ

æ‰§è¡Œä»¥ä¸‹ SQL æ£€æŸ¥å‡½æ•°æ˜¯å¦å­˜åœ¨ï¼š

```sql
SELECT 
    routine_name,
    routine_type
FROM information_schema.routines
WHERE routine_schema = 'public'
  AND routine_name LIKE '%1120%'
ORDER BY routine_name;
```

åº”è¯¥çœ‹åˆ°ï¼š
- âœ… get_invoice_request_data_1120
- âœ… get_payment_request_data_1120
- âœ… å…¶ä»– 1120 ç‰ˆæœ¬çš„å‡½æ•°

---

## ğŸ“Š æ‰§è¡Œåæ£€æŸ¥ç´¢å¼•

```sql
SELECT 
    schemaname,
    tablename,
    indexname
FROM pg_indexes
WHERE schemaname = 'public'
  AND (
    indexname LIKE '%invoice%'
    OR indexname LIKE '%payment%'
  )
ORDER BY tablename, indexname;
```

åº”è¯¥çœ‹åˆ°9ä¸ªæ–°ç´¢å¼•ã€‚

---

**åˆ›å»ºæ—¥æœŸï¼š** 2025-11-20  
**çŠ¶æ€ï¼š** âš ï¸ ç­‰å¾…æ‰§è¡Œ

