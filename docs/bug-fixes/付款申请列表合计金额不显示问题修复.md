# ä»˜æ¬¾ç”³è¯·åˆ—è¡¨åˆè®¡é‡‘é¢ä¸æ˜¾ç¤ºé—®é¢˜ä¿®å¤

## ğŸ› é—®é¢˜æè¿°

åœ¨ä»˜æ¬¾ç”³è¯·åˆ—è¡¨é¡µé¢ï¼Œç­›é€‰"å·²æ”¯ä»˜"çŠ¶æ€æ—¶ï¼Œåˆè®¡é‡‘é¢åˆ—ä¸æ˜¾ç¤ºæˆ–æ˜¾ç¤ºä¸º"-"ã€‚

**æˆªå›¾æ˜¾ç¤º**ï¼š
- è¿å•æ•°æ­£å¸¸æ˜¾ç¤º
- å…¶ä»–åˆ—æ­£å¸¸æ˜¾ç¤º
- å”¯ç‹¬"ç”³è¯·é‡‘é¢"åˆ—æ˜¾ç¤ºä¸º"-"

---

## ğŸ” é—®é¢˜åŸå› 

### æ ¹æœ¬åŸå› 

åœ¨`fetchPaymentRequests`å‡½æ•°ä¸­ï¼Œä»åç«¯RPCå‡½æ•°è·å–æ•°æ®åï¼Œæ˜ å°„åˆ°å‰ç«¯stateæ—¶**é—æ¼äº†`max_amount`å­—æ®µ**ã€‚

**é—®é¢˜ä»£ç **ï¼ˆLine 130-137ï¼‰ï¼š
```typescript
setRequests(requestsData.map(item => ({
  id: item.id,
  created_at: item.created_at,
  request_id: item.request_id,
  status: item.status,
  notes: item.notes,
  logistics_record_ids: item.logistics_record_ids,
  record_count: item.record_count
  // âŒ ç¼ºå°‘: max_amount: item.max_amount
})));
```

### ä¸ºä»€ä¹ˆä¼šå‘ç”Ÿ

1. åç«¯RPCå‡½æ•° `get_payment_requests_filtered` æ­£ç¡®è¿”å›äº† `max_amount`
2. ä½†å‰ç«¯åœ¨æ•°æ®æ˜ å°„æ—¶å¿˜è®°äº†è¿™ä¸ªå­—æ®µ
3. å¯¼è‡´å‰ç«¯stateä¸­çš„ `max_amount` å§‹ç»ˆä¸º `undefined`
4. æ˜¾ç¤ºæ—¶åˆ¤æ–­ä¸ºå‡å€¼ï¼Œæ˜¾ç¤ºä¸º"-"

---

## âœ… ä¿®å¤æ–¹æ¡ˆ

### ä¿®å¤ä»£ç 

```typescript
// âœ… æ·»åŠ  max_amount å­—æ®µæ˜ å°„
setRequests(requestsData.map(item => ({
  id: item.id,
  created_at: item.created_at,
  request_id: item.request_id,
  status: item.status,
  notes: item.notes,
  logistics_record_ids: item.logistics_record_ids,
  record_count: item.record_count,
  max_amount: item.max_amount  // âœ… æ·»åŠ ç”³è¯·é‡‘é¢å­—æ®µ
})));
```

**ä¿®æ”¹ä½ç½®**ï¼š`src/pages/PaymentRequestsList.tsx` Line 137

---

## ğŸ§ª éªŒè¯

### æµ‹è¯•æ­¥éª¤

1. æ‰“å¼€ä»˜æ¬¾ç”³è¯·åˆ—è¡¨é¡µé¢
2. ç­›é€‰"å·²æ”¯ä»˜"çŠ¶æ€
3. æŸ¥çœ‹ç”³è¯·é‡‘é¢åˆ—
4. âœ… åº”è¯¥æ­£å¸¸æ˜¾ç¤ºé‡‘é¢

### é¢„æœŸç»“æœ

```
è¿å•ç¼–å·        çŠ¶æ€      è¿å•æ•°   ç”³è¯·é‡‘é¢
FK-001         å·²æ”¯ä»˜      5æ¡    Â¥2,977.50 âœ…
FK-002         å·²æ”¯ä»˜     17æ¡   Â¥32,138.42 âœ…
FK-003         å·²æ”¯ä»˜     10æ¡   Â¥35,746.61 âœ…
```

---

## ğŸ“Š å½±å“èŒƒå›´

### å—å½±å“çš„åŠŸèƒ½

| åŠŸèƒ½ | å½±å“ | ä¿®å¤å |
|------|------|--------|
| ç­›é€‰å·²æ”¯ä»˜ | âŒ é‡‘é¢ä¸æ˜¾ç¤º | âœ… æ­£å¸¸æ˜¾ç¤º |
| ç­›é€‰å¾…å®¡æ‰¹ | âŒ é‡‘é¢ä¸æ˜¾ç¤º | âœ… æ­£å¸¸æ˜¾ç¤º |
| ç­›é€‰å·²å®¡æ‰¹ | âŒ é‡‘é¢ä¸æ˜¾ç¤º | âœ… æ­£å¸¸æ˜¾ç¤º |
| ç­›é€‰å…¨éƒ¨ | âŒ é‡‘é¢ä¸æ˜¾ç¤º | âœ… æ­£å¸¸æ˜¾ç¤º |

### ä¸ºä»€ä¹ˆæ‰€æœ‰ç­›é€‰éƒ½å—å½±å“ï¼Ÿ

å› ä¸ºé—®é¢˜åœ¨æ•°æ®æ˜ å°„ç¯èŠ‚ï¼Œæ— è®ºç­›é€‰ä»€ä¹ˆçŠ¶æ€ï¼Œéƒ½ä¼šç»è¿‡è¿™ä¸ªæ˜ å°„é€»è¾‘ï¼Œæ‰€ä»¥æ‰€æœ‰æƒ…å†µä¸‹çš„ `max_amount` éƒ½ä¸æ˜¾ç¤ºã€‚

---

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### PaymentRequestæ¥å£

```typescript
interface PaymentRequest {
  id: string;
  created_at: string;
  request_id: string;
  status: 'Pending' | 'Approved' | 'Paid' | 'Rejected' | 'Cancelled';
  notes: string | null;
  logistics_record_ids: string[];
  record_count: number;
  max_amount?: number; // âœ… æ¥å£å®šä¹‰æ˜¯æ­£ç¡®çš„
}
```

### æ˜¾ç¤ºé€»è¾‘

```typescript
<TableCell className="text-right">
  {req.max_amount ? `Â¥${req.max_amount.toLocaleString()}` : '-'}
</TableCell>
```

**é€»è¾‘åˆ†æ**ï¼š
- å¦‚æœ `req.max_amount` å­˜åœ¨ä¸”ä¸ºæ•°å­— â†’ æ˜¾ç¤ºæ ¼å¼åŒ–é‡‘é¢
- å¦‚æœ `req.max_amount` ä¸º `undefined` æˆ– `0` â†’ æ˜¾ç¤º"-"

**ä¹‹å‰çš„é—®é¢˜**ï¼š`req.max_amount` å§‹ç»ˆä¸º `undefined`

---

## ğŸ¯ æœ€ä½³å®è·µ

### æ•°æ®æ˜ å°„å®Œæ•´æ€§æ£€æŸ¥

**åŸåˆ™**ï¼šå‰ç«¯stateçš„å­—æ®µåº”è¯¥ä¸åç«¯è¿”å›çš„å­—æ®µä¸€ä¸€å¯¹åº”

**æ£€æŸ¥æ¸…å•**ï¼š
```typescript
// âœ… æ¨èï¼šå®Œæ•´æ˜ å°„æ‰€æœ‰å­—æ®µ
setRequests(requestsData.map(item => ({
  ...item,  // æˆ–è€…é€ä¸ªåˆ—å‡ºæ‰€æœ‰å­—æ®µ
  // ç¡®ä¿ä¸é—æ¼ä»»ä½•å­—æ®µ
})));

// âŒ ä¸æ¨èï¼šé€‰æ‹©æ€§æ˜ å°„å®¹æ˜“é—æ¼
setRequests(requestsData.map(item => ({
  id: item.id,
  name: item.name,
  // é—æ¼å…¶ä»–å­—æ®µ...
})));
```

---

## ğŸ“ ä¿®å¤æ€»ç»“

**ä¿®æ”¹æ–‡ä»¶**ï¼š`src/pages/PaymentRequestsList.tsx`

**ä¿®æ”¹å†…å®¹**ï¼š
- âœ… åœ¨æ•°æ®æ˜ å°„æ—¶æ·»åŠ  `max_amount` å­—æ®µ
- âœ… Line 137æ·»åŠ ï¼š`max_amount: item.max_amount`

**å½±å“**ï¼š
- âœ… ä¿®å¤æ‰€æœ‰ç­›é€‰æ¡ä»¶ä¸‹é‡‘é¢ä¸æ˜¾ç¤ºçš„é—®é¢˜
- âœ… ä¸å½±å“å…¶ä»–åŠŸèƒ½
- âœ… å‘åå…¼å®¹

**æµ‹è¯•**ï¼š
- âœ… æ‰€æœ‰çŠ¶æ€ç­›é€‰éƒ½èƒ½æ­£å¸¸æ˜¾ç¤ºé‡‘é¢
- âœ… 0ä¸ªæ–°å¢é”™è¯¯

---

**ä¿®å¤å®Œæˆæ—¶é—´**ï¼š2025-01-31  
**é—®é¢˜ä¸¥é‡æ€§**ï¼šä¸­ç­‰ï¼ˆå½±å“æ•°æ®å±•ç¤ºä½†ä¸å½±å“åŠŸèƒ½ï¼‰  
**ä¿®å¤éš¾åº¦**ï¼šç®€å•ï¼ˆä¸€è¡Œä»£ç ï¼‰  
**æ–‡ä»¶å½’æ¡£ä½ç½®**ï¼šdocs/bug-fixes/ï¼ˆéµå¾ªæ–‡æ¡£è§„èŒƒï¼‰âœ…

