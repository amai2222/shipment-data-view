# 文档整理指南

## 📋 为什么要整理文档？

目前项目根目录下有**200+个MD文档**和**50+个SQL文件**，导致：
- ❌ 难以查找需要的文档
- ❌ 新文档不知道放哪里
- ❌ 根目录混乱
- ❌ 维护困难

**整理后的好处**：
- ✅ 清晰的目录结构
- ✅ 快速找到相关文档
- ✅ 便于维护和更新
- ✅ 新人更容易理解项目

---

## 🚀 快速开始

### 方法1：自动整理（推荐）

```powershell
# 1. 整理MD文档
.\organize-docs.ps1

# 2. 整理SQL文件
.\organize-sql-files.ps1
```

**执行后效果**：
- 所有MD文档移至 `docs/` 对应分类目录
- 所有临时SQL移至 `scripts/sql/` 对应目录
- 自动显示整理统计

---

### 方法2：手动整理

参考 `docs/文档整理索引.md` 中的分类，手动移动文件到对应目录。

---

## 📂 目录结构说明

```
项目根目录/
│
├── docs/                          # 📚 所有文档
│   ├── approval-features/         # 审批功能文档
│   ├── invoice-management/        # 开票管理文档
│   ├── payment-management/        # 付款管理文档
│   ├── mobile/                    # 移动端文档
│   ├── components/                # 组件相关文档
│   ├── permissions/               # 权限管理文档
│   ├── project-management/        # 项目管理文档
│   ├── performance/               # 性能优化文档
│   ├── bug-fixes/                 # Bug修复文档
│   ├── daily-summary/             # 工作总结文档
│   ├── database/                  # 数据库文档
│   ├── driver-management/         # 司机管理文档
│   ├── partner-management/        # 合作方管理文档
│   ├── waybill-management/        # 运单管理文档
│   ├── shipper-dashboard/         # 货主看板文档
│   ├── 文档整理索引.md            # 📑 文档索引（重要）
│   └── 文档整理指南.md            # 📖 本文档
│
├── scripts/                       # 🔧 脚本文件
│   ├── sql/                       # SQL脚本
│   │   ├── backup/                # 备份SQL
│   │   ├── fix/                   # 修复SQL
│   │   ├── migration/             # 数据迁移SQL
│   │   └── test/                  # 测试SQL
│   └── backup/                    # 备份脚本
│
├── supabase/                      # Supabase配置
│   └── migrations/                # 🗄️ 数据库迁移文件
│       └── *.sql                  # 按时间戳排序的迁移
│
├── organize-docs.ps1              # 📝 文档整理脚本
├── organize-sql-files.ps1         # 🗃️ SQL整理脚本
│
└── （其他项目文件）
```

---

## 📚 文档分类说明

### 1. approval-features（审批功能）

**包含内容**：
- 开票审核、付款审核相关
- 批量审批、批量取消审批
- 审核流程、权限配置

**最新文档**：
- `审批功能全面优化和企业微信兼容性修复总结.md` ⭐

---

### 2. invoice-management（开票管理）

**包含内容**：
- 开票申请单管理
- 开票筛选器
- 开票申请表功能

**核心文档**：
- `开票申请功能说明.md`
- `一键开票申请自动切分功能说明.md`

---

### 3. payment-management（付款管理）

**包含内容**：
- 付款申请单管理
- 付款筛选器
- 付款按钮逻辑

**核心文档**：
- `付款申请合作链路功能说明.md`
- `付款按钮逻辑修复说明.md`

---

### 4. mobile（移动端）

**包含内容**：
- 移动端优化
- 移动端功能补充
- 移动端快速入门

**最新文档**：
- `移动端审批功能优化完成.md` ⭐

---

### 5. components（组件重构）

**包含内容**：
- 组件库说明
- 组件重构计划
- 可复用组件文档

**核心文档**：
- `组件库完整说明文档.md`

---

### 6. performance（性能优化）

**包含内容**：
- 性能优化指南
- 数据库优化
- 查询优化

**最新文档**：
- `批量取消审批功能优化完成.md` ⭐ (25倍性能提升)

---

### 7. bug-fixes（Bug修复）

**包含内容**：
- 各类Bug修复说明
- Lint错误修复
- TypeScript错误修复

**最新文档**：
- `企业微信环境兼容性修复完成.md` ⭐

---

### 8. daily-summary（工作总结）

**包含内容**：
- 每日工作总结
- 代码审核报告
- 部署清单

**命名规范**：
- `今日完成工作总结_YYYYMMDD.md`
- `代码审核报告_日期.md`

---

## 🗂️ SQL文件分类

### 1. scripts/sql/backup/（备份）

**包含**：
- 数据库备份SQL
- Edge函数备份
- 函数原始备份

**保留期**：永久保留

---

### 2. scripts/sql/fix/（修复）

**包含**：
- 字段修复
- 函数修复
- 触发器修复
- 视图修复

**保留期**：问题解决后可归档

---

### 3. scripts/sql/test/（测试）

**包含**：
- 权限检查
- 数据验证
- 功能测试

**保留期**：测试完成后可删除

---

### 4. scripts/sql/migration/（数据迁移）

**包含**：
- 一次性数据更新
- 批量数据处理
- 权限批量更新

**保留期**：执行完成后可归档

---

### 5. supabase/migrations/（正式迁移）

**包含**：
- 正式的数据库schema变更
- 新增表、函数、触发器
- 版本控制的迁移

**命名规范**：`YYYYMMDD_description.sql`

**保留期**：永久保留，不可删除

---

## 📝 新文档放置规则

### 规则1：按功能分类

```
开发新功能 → 在对应分类目录创建文档

示例：
- 开发开票功能 → docs/invoice-management/
- 优化移动端 → docs/mobile/
- 修复Bug → docs/bug-fixes/
```

---

### 规则2：文档命名

```
[功能模块][操作类型][状态/版本].md

示例：
✅ 批量取消审批功能优化完成.md
✅ 开票审核页面-快速使用指南.md
✅ 移动端审批功能优化完成.md
❌ 说明.md（太模糊）
❌ test.md（不专业）
```

---

### 规则3：更新索引

每次添加重要文档后，更新 `docs/文档整理索引.md`：

```markdown
## 📂 审批功能 (approval-features)

### 最新优化文档
- `新文档名称.md` - 简短说明 ⭐
```

---

## 🔧 维护建议

### 每月维护（第一个工作日）

1. **检查根目录**
   ```powershell
   # 查看根目录MD文件
   Get-ChildItem *.md | Select-Object Name
   
   # 如果有新文件，运行整理脚本
   .\organize-docs.ps1
   ```

2. **检查SQL文件**
   ```powershell
   # 查看根目录SQL文件
   Get-ChildItem *.sql | Select-Object Name
   
   # 如果有新文件，运行整理脚本
   .\organize-sql-files.ps1
   ```

3. **更新文档索引**
   - 打开 `docs/文档整理索引.md`
   - 添加新文档的索引
   - 标注重要文档 ⭐

---

### 季度清理（每3个月）

1. **归档过时文档**
   ```powershell
   # 将过时文档移至archive
   Move-Item "docs\某分类\过时文档.md" "docs\archive\"
   ```

2. **合并重复文档**
   - 检查是否有重复内容的文档
   - 合并后删除重复的

3. **清理临时SQL**
   ```powershell
   # 删除已执行的临时SQL
   Remove-Item "scripts\sql\test\已执行的测试.sql"
   ```

---

## 📊 整理进度

### ✅ 已完成

- [x] 创建目录结构规划
- [x] 编写文档整理脚本
- [x] 编写SQL整理脚本
- [x] 创建文档索引
- [x] 创建整理指南

### 📋 待执行

- [ ] 运行 `organize-docs.ps1` 整理MD文档
- [ ] 运行 `organize-sql-files.ps1` 整理SQL文件
- [ ] 检查整理结果
- [ ] 更新 .gitignore 忽略临时文件

---

## 🎯 最佳实践

### DO ✅

1. **新文档直接放对应目录**
   ```
   开发审批功能 → docs/approval-features/新文档.md
   ```

2. **使用描述性文件名**
   ```
   批量取消审批功能优化完成.md ✅
   ```

3. **重要文档标注星号**
   ```
   - `重要文档.md` ⭐
   ```

4. **定期更新索引**
   ```
   每次添加重要文档后更新索引
   ```

---

### DON'T ❌

1. **避免放根目录**
   ```
   ❌ /新建文档.md
   ✅ /docs/category/新建文档.md
   ```

2. **避免模糊命名**
   ```
   ❌ 说明.md
   ❌ test.md
   ❌ 临时.md
   ```

3. **避免重复文档**
   ```
   检查是否已有类似文档
   ```

4. **避免过时信息**
   ```
   及时归档或删除过时文档
   ```

---

## 📞 技术支持

### 执行问题

**Q: 脚本执行失败怎么办？**

A: 确保PowerShell执行策略允许：
```powershell
Set-ExecutionPolicy -Scope CurrentUser -ExecutionPolicy RemoteSigned
```

---

**Q: 文件移动后找不到了？**

A: 查看 `docs/文档整理索引.md`，按分类查找。

---

**Q: 某个文档应该放哪个目录？**

A: 参考本文档的"文档分类说明"部分。

---

**Q: SQL文件都应该在migrations吗？**

A: 不是。只有正式的schema变更才放 `supabase/migrations/`。
- 临时测试SQL → `scripts/sql/test/`
- 修复脚本 → `scripts/sql/fix/`
- 数据迁移 → `scripts/sql/migration/`

---

## 🎉 整理完成后

### 目录结构效果

```
项目根目录/
├── README.md                      # 项目说明
├── package.json                   # 依赖配置
├── organize-docs.ps1              # 文档整理脚本
├── organize-sql-files.ps1         # SQL整理脚本
│
├── docs/                          # 📚 清爽的文档目录
│   ├── approval-features/         # 5个审批相关文档
│   ├── invoice-management/        # 27个开票相关文档
│   ├── payment-management/        # 26个付款相关文档
│   ├── mobile/                    # 10个移动端文档
│   ├── ... (其他分类)
│   ├── 文档整理索引.md            # 📑 快速查找
│   └── 文档整理指南.md            # 📖 使用说明
│
├── scripts/                       # 🔧 清爽的脚本目录
│   └── sql/                       # 分类清晰的SQL
│       ├── backup/                # 备份SQL
│       ├── fix/                   # 修复SQL
│       ├── migration/             # 迁移SQL
│       └── test/                  # 测试SQL
│
└── supabase/migrations/           # 🗄️ 正式迁移文件
    └── *.sql                      # 版本化的schema变更
```

---

## 📋 执行清单

- [ ] 阅读本文档
- [ ] 运行 `.\organize-docs.ps1`
- [ ] 运行 `.\organize-sql-files.ps1`
- [ ] 检查文档是否正确移动
- [ ] 查看 `docs/文档整理索引.md` 熟悉结构
- [ ] 将整理脚本加入版本控制
- [ ] 更新 .gitignore（如需要）

---

## 🎯 长期维护

### 新文档放置流程

```
1. 完成开发/修复
   ↓
2. 编写文档
   ↓
3. 确定分类（审批？开票？移动端？）
   ↓
4. 放入对应目录：docs/[category]/文档名.md
   ↓
5. 如果是重要文档，更新 docs/文档整理索引.md
   ↓
6. 提交到版本控制
```

---

### 文档审查（季度）

```
1. 检查是否有过时文档
   ↓
2. 归档到 docs/archive/
   ↓
3. 检查是否有重复文档
   ↓
4. 合并重复内容
   ↓
5. 更新文档索引
   ↓
6. 清理临时SQL文件
```

---

## 📈 效果对比

### 整理前

```
根目录/
├── 审批功能文档1.md
├── 审批功能文档2.md
├── 开票文档1.md
├── 付款文档1.md
├── 移动端文档1.md
├── Bug修复1.md
├── ... (200+个文件混在一起)
└── 找文档靠搜索 😫
```

---

### 整理后

```
根目录/
├── docs/
│   ├── approval-features/          # 审批相关都在这
│   │   ├── 文档1.md
│   │   └── 文档2.md
│   ├── invoice-management/         # 开票相关都在这
│   ├── payment-management/         # 付款相关都在这
│   └── 文档整理索引.md             # 快速查找 😊
└── 清爽整洁 ✨
```

---

## 🎊 总结

**整理文档的价值**：
- 🎯 提升开发效率（快速找到文档）
- 💡 便于知识传承（新人快速上手）
- 🧹 项目更专业（清爽的目录结构）
- 📚 便于维护（分类清晰）

**执行时间**：<5分钟

**收益**：长期受益

---

**立即执行整理脚本，让项目更加专业！** 🚀

**文档版本**：v1.0  
**最后更新**：2025-01-31

